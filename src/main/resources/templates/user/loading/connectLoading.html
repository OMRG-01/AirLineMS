<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <title>JetSetFly - Finding Your Flights</title>
	<link rel="icon" type="image/png" th:href="@{/img/fg.png}">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    
    body {
      margin: 0;
      overflow: hidden;
      background-color: #121212;
    }
    
    .video-container {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }
    
    .back-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
      opacity: 0.85;
    }
    
    .content-wrapper {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 600px;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      z-index: 2;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .logo img {
      height: 60px;
      margin-bottom: 10px;
    }
    
    .route-info {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }
    
    .city-route {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 5px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .flight-icon {
      margin: 0 15px;
      color: white;
      animation: pulse 2s infinite;
    }
    
    .trip-details {
      font-size: 16px;
      color: #ccc;
      margin-bottom: 5px;
    }
    
    .divider {
      width: 80%;
      height: 1px;
      background-color: rgba(255, 255, 255, 0.2);
      margin: 20px auto;
    }
    
    .loading-status {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .loading-text {
      font-size: 18px;
      color: white;
      margin-bottom: 15px;
    }
    
    .loading-bar {
      width: 100%;
      height: 6px;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      overflow: hidden;
      position: relative;
    }
    
    .loading-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #a75a82, #e64a7e);
      border-radius: 3px;
      animation: progress 5s linear forwards;
    }
    
    .loading-tips {
      margin-top: 30px;
      text-align: center;
      font-size: 14px;
      color: #aaa;
      font-style: italic;
    }
    
    .loading-tip {
      margin-bottom: 5px;
      opacity: 0;
      animation: fadeInOut 10s infinite;
    }
    
    .loading-tip:nth-child(2) {
      animation-delay: 2.5s;
    }
    
    .loading-tip:nth-child(3) {
      animation-delay: 5s;
    }
    
    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.2);
      }
      100% {
        transform: scale(1);
      }
    }
    
    @keyframes progress {
      0% { width: 0%; }
      10% { width: 15%; }
      30% { width: 40%; }
      50% { width: 60%; }
      70% { width: 75%; }
      90% { width: 90%; }
      100% { width: 100%; }
    }
    
    @keyframes fadeInOut {
      0% { opacity: 0; }
      20% { opacity: 1; }
      80% { opacity: 1; }
      100% { opacity: 0; }
    }
    
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, transparent 30%, rgba(0, 0, 0, 0.6) 100%);
      z-index: 1;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .content-wrapper {
        width: 90%;
        padding: 30px 20px;
      }
      
      .city-route {
        font-size: 22px;
      }
      
      .trip-details {
        font-size: 14px;
      }
      
      .loading-text {
        font-size: 16px;
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
  <div class="video-container">
    <div class="overlay"></div>
    <video autoplay loop muted playsinline class="back-video" id="myVideo">
      <source th:src="@{/assets/blue.mp4}" type="video/mp4" th:if="${nop == 1}">
      <source th:src="@{/assets/red.mp4}" type="video/mp4" th:if="${nop == 2}">
      <source th:src="@{/assets/yellow.mp4}" type="video/mp4" th:if="${nop == 3}">
      <source th:src="@{/assets/purple.mp4}" type="video/mp4" th:if="${nop != 1 and nop != 2 and nop != 3}">
    </video>
    
    <div class="content-wrapper">
      <div class="logo">
        <img th:src="@{/assets/jetsetflylogoinwhite.png}" alt="JetSetFly Logo">
      </div>
      
      <div class="route-info">
		<div class="city-route">
		  <span th:text="${sourceCity}"></span>
		  <span class="flight-icon"><i class="fa-solid fa-plane"></i></span>
		  <span th:text="${destinationCity}"></span>
		</div>
		<div class="trip-details">
		  <span th:text="${date}"></span>
		  â€¢
		  <span th:text="${passenger + ' passenger' + (passenger > 1 ? 's' : '')}"></span>
		</div>
      </div>
      
      <div class="divider"></div>
      
      <div class="loading-status">
        <div class="loading-text">Finding the best fares for you...</div>
        <div class="loading-bar">
          <div class="loading-progress"></div>
        </div>
      </div>
      
      <div class="loading-tips">
        <div class="loading-tip">Did you know? Morning flights have a higher probability of on-time departure.</div>
        <div class="loading-tip">JetSetFly offers exclusive deals for frequent flyers. Check your profile!</div>
        <div class="loading-tip">Travel tip: Pack an empty water bottle to refill after security check.</div>
      </div>
    </div>
  </div>

  <script th:inline="javascript">
    /*<![CDATA[*/
	const source = /*[[${source}]]*/ 0;
	  const destination = /*[[${destination}]]*/ 0;
	  const date = /*[[${date}]]*/ '2025-05-30';
	  const passenger = /*[[${passenger}]]*/ 1;
    
    // Show different loading tips
    let tipIndex = 0;
    const tips = [
      "Did you know? Morning flights have a higher probability of on-time departure.",
      "JetSetFly offers exclusive deals for frequent flyers. Check your profile!",
      "Travel tip: Pack an empty water bottle to refill after security check.",
      "Window or aisle? Studies show window seats offer better sleep on long flights.",
      "Our price match guarantee ensures you always get the best deal!"
    ];
    
    // Function to ensure video playback starts
	window.addEventListener('load', function () {
	   const video = document.getElementById('myVideo');
	   if (video) {
	     video.play().catch(error => {
	       console.log("Video autoplay prevented:", error);
	     });
	   }
	 });
    
    // Redirect after loading animation completes
	setTimeout(() => {
	  const url = `/search-flights?source=${source}&destination=${destination}&date=${date}&passenger=${passenger}`;
	  window.location.href = url;
	}, 5000);
    /*]]>*/
  </script>
</body>

</html>