<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
   <head>
      <meta charset="UTF-8">
      <link rel="icon" type="image/png" th:href="@{/img/fg.png}">
      <link rel="stylesheet" th:href="@{/css/home.css}">
      <link rel="stylesheet" th:href="@{/css/autosearch.css}">
      <link href="https://cdn.jsdelivr.net/npm/remixicon@3.4.0/fonts/remixicon.css" rel="stylesheet" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
      <title>Flight Suggestions</title>
      <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
      <style>
         :root {
         --primary-color: #721b47;
         --text-dark: #333;
         }
		 body {
		            font-family: 'Poppins', sans-serif;
		            background: #f5f7fa;
		            margin: 0;
		            padding: 20px;
		        }
         /* Header Styles - Preserved */
         header {
         position: fixed;
         top: 0;
         left: 0;
		
         width: 100%;
         display: flex;
         justify-content: space-between;
         align-items: center;
         transition: 0.6s;
         padding: 10px 20px 0 30px;
         z-index: 10000;
         background: rgba(255, 255, 255, 0.95);
         backdrop-filter: blur(10px);
         box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
         }
         header .logo {
         font-weight: 700;
         text-decoration: none;
         font-size: 1.5rem;
         text-transform: uppercase;
         letter-spacing: 2px;
         transition: 0.6s;
         }
         header ul {
         display: flex;
         justify-content: center;
         align-items: center;
         }
         header ul li {
         margin-right: 15px;
         list-style: none;
         }
         header ul li:last-child {
         margin-right: 0;
         }
         header ul li a {
         margin: 0 15px;
         text-decoration: none;
         color: var(--primary-color);
         letter-spacing: 2px;
         font-weight: 700;
         transition: 0.6s;
         }
         .nav__logo img {
         height: 50px;
         width: 150px;
         margin-right: 10px;
         }
         .nav__links {
         list-style: none;
         display: flex;
         align-items: center;
         gap: 2rem;
         }
         .nav__links li {
         list-style: none;
         display: inline-block;
         padding: 8px 12px;
         position: relative;
         font-family: 'Poppins', sans-serif;
         }
         .nav__links li a {
         color: var(--text-dark);
         text-decoration: none;
         font-weight: 700;
         font-family: 'Poppins', sans-serif;
         }
         .nav__links li::after {
         content: '';
         width: 0%;
         height: 2px;
         background: var(--primary-color);
         display: block;
         margin: auto;
         transition: 0.5s;
         }
         .nav__links li:hover::after {
         width: 80%;
         }
         .btn {
         background: var(--primary-color);
         color: white;
         border: none;
         padding: 10px 20px;
         border-radius: 25px;
         font-weight: 600;
         transition: all 0.3s ease;
         }
         .btn:hover {
         background: #8b2557;
         transform: translateY(-2px);
         box-shadow: 0 5px 15px rgba(114, 27, 71, 0.3);
         }
         /* Main Content Styles */
         .main-container {
         max-width: 1200px;
         margin: 0 auto;
         padding: 20px;
		 margin-top: 50px;
         }
         .page-header {
         text-align: center;
         margin-bottom: 40px;
         }
         .page-header h2 {
         color: var(--primary-color);
         font-weight: 700;
         font-size: 2.5rem;
         margin-bottom: 10px;
         }
         .page-header p {
         color: #666;
         font-size: 1.1rem;
         }
         /* Modern Flight Card Design */
         .flight-card {
         background: white;
         border-radius: 20px;
         padding: 30px;
         margin-bottom: 25px;
         box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
         border: 1px solid rgba(114, 27, 71, 0.1);
         transition: all 0.3s ease;
         position: relative;
         overflow: hidden;
         }
         .flight-card::before {
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         right: 0;
         height: 4px;
         background: linear-gradient(90deg, var(--primary-color), #a8336b);
         }
         .flight-card:hover {
         transform: translateY(-5px);
         box-shadow: 0 15px 40px rgba(114, 27, 71, 0.15);
         }
         .flight-route {
         display: flex;
         align-items: center;
         justify-content: space-between;
         margin-bottom: 25px;
         position: relative;
         }
         .route-point {
         text-align: center;
         flex: 1;
         }
         .route-point h4 {
         font-size: 2rem;
         font-weight: 700;
         color: var(--text-dark);
         margin: 0;
         }
         .route-point .city-name {
         font-size: 0.9rem;
         color: #666;
         font-weight: 500;
         margin-top: 5px;
         }
         .route-connector {
         flex: 2;
         display: flex;
         align-items: center;
         justify-content: center;
         position: relative;
         margin: 0 20px;
         }
         .route-line {
         width: 100%;
         height: 2px;
         background: linear-gradient(90deg, #e0e0e0, var(--primary-color), #e0e0e0);
         position: relative;
         }
         .plane-icon {
         position: absolute;
         top: 50%;
         left: 50%;
         transform: translate(-50%, -50%);
         background: white;
         border: 3px solid var(--primary-color);
         border-radius: 50%;
         width: 40px;
         height: 40px;
         display: flex;
         align-items: center;
         justify-content: center;
         color: var(--primary-color);
         font-size: 16px;
         }
         .flight-details {
         display: grid;
         grid-template-columns: 1fr 1fr;
         gap: 30px;
         margin-top: 25px;
         padding-top: 25px;
         border-top: 1px solid #f0f0f0;
         }
         .detail-section h6 {
         color: var(--primary-color);
         font-weight: 600;
         font-size: 0.9rem;
         text-transform: uppercase;
         letter-spacing: 0.5px;
         margin-bottom: 10px;
         }
		 .detail-section-arrive {
		          color: var(--primary-color);
		          font-weight: 600;
		          font-size: 0.9rem;
		          text-transform: uppercase;
		          letter-spacing: 0.5px;
		          margin-bottom: 10px;
				  text-align: right;
		          }
		 
         .time-display {
         font-size: 1.8rem;
         font-weight: 700;
         color: var(--text-dark);
         margin-bottom: 5px;
         }
         .date-display {
         color: #666;
         font-size: 0.95rem;
         }
         .flight-info-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
         gap: 20px;
         margin-top: 20px;
         padding: 20px;
         background: #f8f9fa;
         border-radius: 12px;
         }
         .info-item {
         display: flex;
         align-items: center;
         gap: 10px;
         }
         .info-item i {
         color: var(--primary-color);
         width: 20px;
         }
         .info-item .label {
         font-weight: 600;
         color: var(--text-dark);
         }
         .info-item .value {
         color: #666;
         margin-left: auto;
         }
         /* Section Headers */
         .section-header {
         display: flex;
         align-items: center;
         gap: 15px;
         margin: 40px 0 25px 0;
         padding: 15px 25px;
         background: white;
         border-radius: 12px;
         box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
         }
         .section-header h4 {
         color: var(--primary-color);
         font-weight: 700;
         margin: 0;
         font-size: 1.4rem;
         }
         .section-header i {
         color: var(--primary-color);
         font-size: 1.5rem;
         }
         /* Route Path Visualization */
         .route-path-visual {
         background: linear-gradient(135deg, var(--primary-color), #a8336b);
         color: white;
         padding: 25px;
         border-radius: 15px;
         margin-bottom: 30px;
         position: relative;
         overflow: hidden;
         }
         .route-path-visual::before {
         content: '';
         position: absolute;
         top: -50%;
         right: -50%;
         width: 100%;
         height: 200%;
         background: rgba(255, 255, 255, 0.1);
         transform: rotate(45deg);
         }
         .path-cities {
         display: flex;
         align-items: center;
         justify-content: center;
         flex-wrap: wrap;
         gap: 20px;
         position: relative;
         z-index: 1;
         }
         .path-city {
         display: flex;
         align-items: center;
         gap: 8px;
         font-weight: 600;
         font-size: 1.1rem;
         }
         .path-arrow {
         color: rgba(255, 255, 255, 0.8);
         font-size: 1.2rem;
         }
         /* Alerts */
         .alert-custom {
         border-radius: 12px;
         border: none;
         padding: 20px 25px;
         margin-bottom: 25px;
         display: flex;
         align-items: center;
         gap: 15px;
         }
         .alert-danger {
         background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
         color: white;
         }
         .alert-warning {
         background: linear-gradient(135deg, #feca57, #ff9ff3);
         color: white;
         }
         /* Back Button */
         .back-button-container {
         text-align: center;
         margin-top: 50px;
         padding: 30px;
         }
         .back-btn {
         background: linear-gradient(135deg, var(--primary-color), #a8336b);
         border: none;
         padding: 15px 40px;
         border-radius: 30px;
         font-weight: 600;
         font-size: 1.1rem;
         color: white;
         text-decoration: none;
         display: inline-flex;
         align-items: center;
         gap: 10px;
         transition: all 0.3s ease;
         box-shadow: 0 5px 20px rgba(114, 27, 71, 0.3);
         }
         .back-btn:hover {
         transform: translateY(-3px);
         box-shadow: 0 8px 25px rgba(114, 27, 71, 0.4);
         color: white;
         }
         /* Responsive Design */
         @media (max-width: 768px) {
         .flight-route {
         flex-direction: column;
         gap: 20px;
         }
         .route-connector {
         transform: rotate(90deg);
         margin: 10px 0;
         }
         .flight-details {
         grid-template-columns: 1fr;
         gap: 20px;
         }
         .path-cities {
         flex-direction: column;
         }
         .nav__links {
         display: none;
         }
         }
		 .class-options {
		     display: flex;
		     gap: 15px;
		     flex-wrap: wrap;
		     margin-top: 20px;
		 }

		 .class-card {
		     flex: 1;
		     min-width: 200px;
		     padding: 15px;
		     border: 1px solid #e0e0e0;
		     border-radius: 8px;
		     background-color: #f9f9f9;
		     text-align: center;
		     box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		     transition: transform 0.2s ease;
		 }

		 .class-card:hover {
		     transform: translateY(-2px);
		     box-shadow: 0 4px 8px rgba(0,0,0,0.15);
		 }

		 .class-card h4 {
		     margin-bottom: 10px;
		     color: #333;
		 }

		 .class-card h5 {
		     color: #2c5530;
		     font-size: 18px;
		     font-weight: bold;
		     margin-bottom: 5px;
		 }

		 .class-card p {
		     margin-bottom: 15px;
		 }

		 .select-btn {
		     background-color: #721b47;
		     color: white;
		     border: none;
		     padding: 10px 20px;
		     border-radius: 5px;
		     cursor: pointer;
		     font-weight: bold;
		     width: 100%;
		     transition: background-color 0.3s ease;
		 }

		 .select-btn:hover {
		     background-color: #721b47;
		 }

		 .select-btn.disabled {
		     background-color: #6c757d;
		     cursor: not-allowed;
		 }

		 .unavailable-class {
		     color: #dc3545;
		     font-weight: bold;
		     font-size: 16px;
		     padding: 20px 0;
		 }

		 /* Responsive design */
		 @media (max-width: 768px) {
		     .class-options {
		         flex-direction: column;
		     }
		     
		     .class-card {
		         min-width: 100%;
		     }
		 }
      </style>
   </head>
   <body>
      <!-- Header - Preserved exactly as original -->
      <header>
         <div class="nav__logo"><img th:src="@{/assets/jetsetflylogo.png}" alt="JetSetFly Logo"></div>
         <ul class="nav__links">
            <li class="link"><a th:href="@{/user/userDash}">HOME</a></li>
            <li class="link"><a th:href="@{/user/bookings}">MY FLIGHTS</a></li>
            <li class="link"><a th:href="@{/user/review}">REVIEW</a></li>
            <li class="link"><a th:href="@{/user/profileEdit}">Profile</a></li>
         </ul>
         <a th:href="@{/user/logout}"><button class="btn">Login &nbsp;<i class="fa fa-sign-in" style="font-size:15px"></i></button></a>
      </header>
      <!-- Main Content -->
      <div class="main-container">
         <!-- Page Header -->
         <div class="page-header">
            <h2><i class="fas fa-plane me-3"></i>Flight Search Results</h2>
            <p>Find the perfect flight for your journey</p>
         </div>
         <!-- Error Alert -->
         <div th:if="${error}" class="alert alert-danger alert-custom" role="alert">
            <i class="fas fa-exclamation-triangle"></i>
            <span th:text="${error}">Error message</span>
         </div>
         <!-- Direct Flights Section -->
         <div th:if="${directFlights != null and !directFlights.isEmpty()}">
            <div class="section-header">
               <i class="fas fa-paper-plane"></i>
               <h4>Direct Flights Available</h4>
            </div>
            <div th:each="flight : ${directFlights}" class="flight-card">
               <div class="flight-route">
                  <div class="route-point">
                     <h4 th:text="${flight.source.cityname}">NSK</h4>
                  </div>
                  <div class="route-connector">
                     <div class="route-line"></div>
                     <div class="plane-icon">
                        <i class="fas fa-plane"></i>
                     </div>
                  </div>
                  <div class="route-point">
                     <h4 th:text="${flight.destination.cityname}">BOM</h4>
                     
                  </div>
               </div>
               <div class="flight-details">
                  <div class="detail-section">
                     <h6>Departure</h6>
                     <div class="time-display" th:text="${#temporals.format(flight.departAt, 'HH:mm')}">15:23</div>
                     <div class="date-display"  th:text="${#temporals.format(flight.departAt, 'EEE, dd MMM')}">Sat, 11 Oct</div>
                  </div>
                  <div class="detail-section-arrive" >
                     <h6>Arrival</h6>
                     <div class="time-display" th:text="${#temporals.format(flight.arriveAt, 'HH:mm')}">12:20</div>
                     <div class="date-display"  th:text="${#temporals.format(flight.arriveAt, 'EEE, dd MMM')}">Sat, 18 Oct</div>
                  </div>
               </div>
               <div class="flight-info-grid">
                  <div class="info-item">
                     <i class="fas fa-plane"></i>
                     <span class="label">Flight</span>
                     <span class="value" th:text="${flight.flightNumber}">VS 901</span>
                  </div>
                  <div class="info-item">
                     <i class="fas fa-building"></i>
                     <span class="label">Airline</span>
                     <span class="value" th:text="${flight.flight.airline.aname}">Vistara</span>
                  </div>
                  <div class="info-item">
                     <i class="fas fa-clock"></i>
                     <span class="label">Duration</span>
                     <span class="value">4h 57m</span>
                  </div>
                  <div class="info-item">
                     <i class="fas fa-chair"></i>
                     <span class="label">Class</span>
                     <span class="value">First,Business and Economy</span>
                  </div>
               </div>
               <div class="class-options">
                  <div th:each="rate : ${scheduleRatesMap[flight.id]}" class="class-card">
                     <div>
                        <!-- Class Name -->
                        <h4 style="font-weight:bold;" th:text="${rate.flightClass.name}"></h4>
                     </div>
                     <!-- Price Check -->
                     <div th:if="${rate.rate > 0}">
                        <h5 th:text="'INR ' + ${rate.rate}"></h5>
                        <p style="font-size:15px;color:gray;margin-top:15px;">
                           Available seats:
                           <span th:text="${availableSeatsMap[flight.id + '-' + rate.flightClass.id]}">0</span>
                        </p>
                        <div>
                           <!-- IF user is logged in and seats available: Show booking form -->
                           <form th:if="${currentUser != null and availableSeatsMap[flight.id + '-' + rate.flightClass.id] > 0}"
                              th:action="@{/booking/initiate}"
                              method="post"
                              th:unless="${availableSeatsMap[flight.id + '-' + rate.flightClass.id] == 0}">
                              <input type="hidden" name="userId" th:value="${currentUser.id}" />
                              <input type="hidden" name="flightId" th:value="${flight.flight.id}" />
                              <input type="hidden" name="airlineId" th:value="${flight.flight.airline.id}" />
                              <input type="hidden" name="scheduleId" th:value="${flight.id}" />
                              <input type="hidden" name="flightClassId" th:value="${rate.flightClass.id}" />
                              <input type="hidden" name="nos_passanger" th:value="${passengerId}" />
                              <input type="hidden" name="rate" th:value="${rate.rate}" />
                              <button type="submit" class="select-btn">Book Now</button>
                           </form>
                           <!-- Show disabled button if no seats -->
                           <button th:if="${currentUser != null and availableSeatsMap[flight.id + '-' + rate.flightClass.id] == 0}"
                              class="select-btn disabled"
                              disabled>No Seats Available</button>
                        </div>
                     </div>
                     <!-- Price Not Set = Class Not Available -->
                     <div th:if="${rate.rate == 0}" class="unavailable-class">
                        Class Not<br>Available
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <!-- No Connecting Flights Alert -->
         <div th:if="${noConnectingFlights}" class="alert alert-warning alert-custom" role="alert">
            <i class="fas fa-info-circle"></i>
            <span>No valid connecting flights found due to insufficient layover time.</span>
         </div>
		 <!-- connectedFlights.html -->
		 <div th:if="${connectingFlights}">
		     <div class="section-header">
		         <i class="fas fa-route"></i>
		         <h4>Suggested Flight Routes</h4>
		     </div>

		     <!-- Route Path Visualization -->
		     <div class="route-path-visual">
		         <h6 class="mb-3">
		             <i class="fas fa-map-marked-alt me-2"></i>
		             Your Journey Path
		         </h6>
		         <div class="path-cities">
		             <span th:each="city, cityStat : ${multiHopPath}" class="path-city">
		                 <i class="fas fa-map-marker-alt"></i>
		                 <span th:text="${city.cityname}">City Name</span>
		                 <span th:if="${!cityStat.last}" class="path-arrow">
		                     <i class="fas fa-arrow-right"></i>
		                 </span>
		             </span>
		         </div>
				 
		     </div>

		     <!-- Flight Segments -->
		     <div th:each="segment, segmentStat : ${connectingFlights}">
		         <div class="section-header">
		             <i class="fas fa-plane-departure"></i>
		             <h4>
		                 <span th:text="${multiHopPath[segmentStat.index].cityname}">Source</span> 
		                 â†’ 
		                 <span th:text="${multiHopPath[segmentStat.index + 1].cityname}">Destination</span>
		             </h4>
		         </div>

		         <div th:each="flight : ${segment}" class="flight-card">
		             <div class="flight-route">
		                 <div class="route-point">
		                     <h4 th:text="${multiHopPath[segmentStat.index].cityname}">SRC</h4>
		                     <div class="city-name">Source City</div>
		                 </div>
		                 <div class="route-connector">
		                     <div class="route-line"></div>
		                     <div class="plane-icon">
		                         <i class="fas fa-plane"></i>
		                     </div>
		                 </div>
		                 <div class="route-point">
		                     <h4 th:text="${multiHopPath[segmentStat.index + 1].cityname}">DEST</h4>
		                     <div class="city-name">Destination City</div>
		                 </div>
		             </div>

					 <div class="flight-details">
					                  <div class="detail-section">
					                     <h6>Departure</h6>
					                     <div class="time-display" th:text="${#temporals.format(flight.departAt, 'HH:mm')}">15:23</div>
					                     <div class="date-display"  th:text="${#temporals.format(flight.departAt, 'EEE, dd MMM')}">Sat, 11 Oct</div>
					                  </div>
					                  <div class="detail-section-arrive" >
					                     <h6>Arrival</h6>
					                     <div class="time-display" th:text="${#temporals.format(flight.arriveAt, 'HH:mm')}">12:20</div>
					                     <div class="date-display"  th:text="${#temporals.format(flight.arriveAt, 'EEE, dd MMM')}">Sat, 18 Oct</div>
					                  </div>
					               </div>

		             <div class="flight-info-grid">
		                 <div class="info-item">
		                     <i class="fas fa-plane"></i>
		                     <span class="label">Flight</span>
		                     <span class="value" th:text="${flight.flightNumber}">AI 101</span>
		                 </div>
		                 <div class="info-item">
		                     <i class="fas fa-building"></i>
		                     <span class="label">Airline</span>
		                     <span class="value" th:text="${flight.flight.airline.aname}">Airline Name</span>
		                 </div>
		                 <div class="info-item">
		                     <i class="fas fa-clock"></i>
		                     <span class="label">Duration</span>
		                     <span class="value">4h 15m</span>
		                 </div>
		                 <div class="info-item">
		                     <i class="fas fa-chair"></i>
		                     <span class="label">Class</span>
		                     <span class="value">First, Business, Economy</span>
		                 </div>
		             </div>

		             <div class="class-options">
		                 <div th:each="rate : ${scheduleRatesMap[flight.id]}" class="class-card">
		                     <div>
		                         <h4 style="font-weight:bold;" th:text="${rate.flightClass.name}">Class Name</h4>
		                     </div>
		                     <div th:if="${rate.rate > 0}">
		                         <h5 th:text="'INR ' + ${rate.rate}">INR 0</h5>
		                         <p style="font-size:15px;color:gray;margin-top:15px;">
		                             Available seats:
		                             <span th:text="${availableSeatsMap[flight.id + '-' + rate.flightClass.id]}">0</span>
		                         </p>
		                     </div>
		                     <div th:if="${rate.rate == 0}" class="unavailable-class">
		                         Class Not<br>Available
		                     </div>
		                 </div>
		             </div>
		         </div>
		     </div>

		     <!-- Final Common Classes Section -->
		     <div class="section-header mt-5">
		         <i class="fas fa-list-alt"></i>
		         <h4>Common Available Classes for Entire Trip</h4>
		     </div>

		     <div th:if="${#lists.size(commonClassInfo) > 0}">
		         <div class="row">
		             <div class="col-md-4" th:each="entry : ${commonClassInfo}">
		                 <div class="card p-3 mb-4">
		                     <h5 th:text="${entry.value['className']}">Economy</h5>
		                     <p>
		                         <strong>Total Fare:</strong>
		                         <span th:text="'INR ' + ${entry.value['totalRate']}">INR 0</span>
		                     </p>

							 <form method="post" th:action="@{/user/book-connecting}" id="bookingForm">
							     <input type="hidden" name="flightClassId" th:value="${entry.key}" />
							     <input type="hidden" name="rate" th:value="${entry.value['totalRate']}" />
							     <input type="hidden" name="noOfPassengers" th:value="${passengerId}" />
							     <input type="hidden" name="userId" th:value="${currentUser.id}" />

							     <!-- Multiple hidden inputs for scheduleFlightIds -->
							     <input type="hidden" name="scheduleFlightIds" th:each="id : ${connectingFlightIds}" th:value="${id}" />

							     <button class="btn btn-primary" th:disabled="${entry.value['availableSeats']} < ${passengerId}">
							         Book This Class
							     </button>
							 </form>
		                 </div>
		             </div>
		         </div>
		     </div>

		     <div th:if="${#lists.size(commonClassInfo) == 0}">
		         <div class="alert alert-warning mt-4">
		             Sorry, no common classes available for all segments.
		         </div>
		     </div>
		 </div>

         <!-- Back to Search Button -->
         <div class="back-button-container">
            <a href="/search-form" class="back-btn">
            <i class="fas fa-search"></i>
            Back to Search
            </a>
         </div>
      </div>
      <script>
         document.addEventListener("DOMContentLoaded", function () {
             const flightCards = document.querySelectorAll(".flight-card");
         
             flightCards.forEach(card => {
                 const departTimeElem = card.querySelector(".flight-details .detail-section:nth-child(1) .time-display");
                 const arriveTimeElem = card.querySelector(".flight-details .detail-section:nth-child(2) .time-display");
         
                 const durationValueElem = Array.from(card.querySelectorAll(".info-item")).find(item => {
                     return item.querySelector("i.fas.fa-clock") !== null;
                 })?.querySelector(".value");
         
                 if (!departTimeElem || !arriveTimeElem || !durationValueElem) {
                     return;
                 }
         
                 const departISO = departTimeElem.textContent.trim();
                 const arriveISO = arriveTimeElem.textContent.trim();
         
                 // Try to parse as Date
                 const departDate = new Date(departISO);
                 const arriveDate = new Date(arriveISO);
         
                 if (isNaN(departDate.getTime()) || isNaN(arriveDate.getTime())) {
                     durationValueElem.textContent = "--";
                     return;
                 }
         
                 // Handle next-day arrival if needed
                 if (arriveDate < departDate) {
                     arriveDate.setDate(arriveDate.getDate() + 1);
                 }
         
                 const durationMs = arriveDate - departDate;
                 const hours = Math.floor(durationMs / (1000 * 60 * 60));
                 const minutes = Math.floor((durationMs % (1000 * 60 * 60)) / (1000 * 60));
         
                 durationValueElem.textContent = `${hours}h ${minutes}m`;
             });
         });
         
         
      </script>
	  <script>
	  function printFormData() {
	      const form = document.getElementById('bookingForm');
	      const formData = new FormData(form);
	      const data = {};

	      // Convert FormData entries to a plain object for better visibility
	      for (const [key, value] of formData.entries()) {
	          // For fields like segments[0].flightId, group them
	          if (key.startsWith('segments')) {
	              // Extract index and field from key, e.g., segments[0].flightId
	              const match = key.match(/segments\[(\d+)\]\.(.+)/);
	              if (match) {
	                  const index = match[1];
	                  const field = match[2];
	                  if (!data.segments) data.segments = [];
	                  if (!data.segments[index]) data.segments[index] = {};
	                  data.segments[index][field] = value;
	              }
	          } else {
	              data[key] = value;
	          }
	      }

	      // Print nicely formatted JSON in console
	      console.log("Booking Form Data:", data);

	      // Optionally show in alert or modal
	      alert(JSON.stringify(data, null, 2));
	  }
	  </script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
   </body>
</html>